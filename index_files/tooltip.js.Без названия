if("undefined"==typeof $oWoW&&($oWoW={cdnUrl:"//cdn.warmane.com",expUrl:"db.warmane.com"}),void 0===$oWoWTooltip)var $oWoWTooltip=new function(){function init(){if(external){var a=document.createElement("script");a.src=$oWoW.cdnUrl+"/api/global.js",headtag.appendChild(a)}else attachEvent()}function attachEvent(){eventAttached||(eventAttached=!0,$oWoW.aE(document,"mouseover",onMouseOver))}function onDOMReady(a){if("undefined"!=typeof jQuery)return void jQuery(a);/in/.test(document.readyState)?setTimeout(onDOMReady.bind(null,a),9):a()}function updateCursorPos(a){var b=$oWoW.getCursorPos(a);cursorX=b.x,cursorY=b.y}function scanElement(t,e){if("A"!=t.nodeName&&"AREA"!=t.nodeName)return-9999;if((t.href.length||t.rel)&&(!t.rel||-1==t.rel.indexOf("np")||t.rel.indexOf("np")==t.rel.indexOf("npc="))){var i0,i1,i2,url,params={};currentParams=params;var p=function(a,b,c){"buff"==b||"sock"==b||"map"==b?params[b]=!0:"rand"==b||"ench"==b||"lvl"==b||"c"==b||"transmog"==b?params[b]=parseInt(c):"gems"==b||"pcs"==b||"know"==b?params[b]=c.split(":"):"text"==b&&(params[b]=!0)};if(1&method.type&&(i1=2,i2=3,0==t.href.indexOf("http://")||0==t.href.indexOf("https://")?(i0=1,url=t.href.match(/^https?:\/\/db.warmane\.com\/(tbc|wotlk|cata|mop)\/(item|quest|spell|achievement|npc|object)=([0-9]+)/)):url=t.href.match(/()\?(item|quest|spell|achievement|npc|object)=([0-9]+)/)),null==url&&t.rel&&2&method.type&&(i0=0,i1=1,i2=2,url=t.rel.match(/(item|quest|spell|achievement|npc|object).?([0-9]+)/)),t.href.replace(/([a-zA-Z]+)=?([a-zA-Z0-9:-]*)/g,p),t.rel&&t.rel.replace(/([a-zA-Z]+)=?([a-zA-Z0-9:-]*)/g,p),params.gems&&params.gems.length>0){var i;for(i=Math.min(3,params.gems.length-1);i>=0&&!parseInt(params.gems[i]);--i);++i,0==i?delete params.gems:i<params.gems.length&&(params.gems=params.gems.slice(0,i))}if(url){var locale,domain="www",expansion="wotlk";if(currentA=t,i0&&url[i0]&&(domain=url[i0].split(".")[0]),locale=$oWoW.getLocaleFromDomain(domain),expansion=$oWoW.getExpansionFromDomain(domain),currentDomain=domain,-1!=t.href.indexOf("#")&&-1!=document.location.href.indexOf(url[i1]+"="+url[i2]))return;mode=0==t.parentNode.className.indexOf("icon")&&"DIV"==t.parentNode.nodeName?1:0,t.onmouseout||(0==mode&&(t.onmousemove=onMouseMove),t.onmouseout=onMouseOut),e&&updateCursorPos(e);var type=$oWoW.getIdFromTypeName(url[i1]),typeId=url[i2];if(display(type,typeId,locale,params,expansion),e||"undefined"==typeof ttConf)return;var data=LOOKUPS[type][0][expansion][getFullId(typeId,params)],timeout=function(t){if(data.status[locale]!=STATUS_OK&&data.status[locale]!=STATUS_NOTFOUND&&data.status[locale]!=STATUS_INVALID&&data.status[locale]!=STATUS_ERROR)return void window.setTimeout(function(){timeout(t)},5);ttConf.rename&&(t.innerHTML=""),ttConf.icons&&data.icon&&(type==TYPE_ITEM||type==TYPE_ACHIEVEMENT||type==TYPE_SPELL)&&(external?(t.className+=" icontiny",ttConf.iconsize?t.innerHTML=t.innerHTML+'<img style="width: '+ttConf.iconsize+"px; height: "+ttConf.iconsize+'px;" src="//cdn.warmane.com/'+domain+"/icons/tiny/"+data.icon.toLocaleLowerCase()+'.gif">':t.innerHTML=t.innerHTML+'<img style="width:15px; height:15px;" src="//cdn.warmane.com/'+domain+"/icons/tiny/"+data.icon.toLocaleLowerCase()+'.gif">'):(t.className+=" icontinyl",t.style.background="url(//cdn.warmane.com/"+domain+"/icons/tiny/"+data.icon.toLocaleLowerCase()+".gif)")),ttConf.rename&&(eval("name = data.name_"+LOCALES[locale]),"undefined"!=typeof name&&"undefined"!=name&&(t.innerHTML=t.innerHTML+name)),ttConf.qualitycolor&&(type==TYPE_ITEM&&(void 0!==ttConf.overridecolor&&void 0!==ttConf.overridecolor.items&&ttConf.overridecolor.items?t.style.color=ttConf.overridecolor.items:t.className+=" q"+data.quality),void 0!==ttConf.overridecolor&&(type==TYPE_SPELL&&void 0!==ttConf.overridecolor.spells&&ttConf.overridecolor.spells&&(t.style.color=ttConf.overridecolor.spells),type==TYPE_ACHIEVEMENT&&void 0!==ttConf.overridecolor.achievements&&ttConf.overridecolor.achievements&&(t.style.color=ttConf.overridecolor.achievements),type==TYPE_QUEST&&void 0!==ttConf.overridecolor.quests&&ttConf.overridecolor.quests&&(t.style.color=ttConf.overridecolor.quests),type==TYPE_NPC&&void 0!==ttConf.overridecolor.npcs&&ttConf.overridecolor.npcs&&(t.style.color=ttConf.overridecolor.npcs),type==TYPE_OBJECT&&void 0!==ttConf.overridecolor.objects&&ttConf.overridecolor.objects&&(t.style.color=ttConf.overridecolor.objects)))};timeout(t)}}}function onMouseOver(a){a=$oWoW.evt(a);for(var b=a._target,c=0;null!=b&&c<5&&-9999==scanElement(b,a);)b=b.parentNode,++c}function onMouseMove(a){a=$oWoW.evt(a),updateCursorPos(a),$oWoW.Tooltip.move(cursorX,cursorY,0,0,CURSOR_HSPACE,CURSOR_VSPACE)}function onMouseOut(){currentType=null,currentA=null,$oWoW.Tooltip.hide()}function getTooltipField(a,b){var c="tooltip";return currentParams&&currentParams.buff&&(c="buff"),currentParams&&currentParams.text&&(c="text"),currentParams&&currentParams.premium&&(c="tooltip_premium"),c+(b||"")+"_"+LOCALES[a]}function getIconField(){return currentParams&&currentParams.text?"text_icon":"icon"}function getSpellsField(a){return(currentParams&&currentParams.buff?"buff":"")+"spells_"+LOCALES[a]}function initElement(a,b,c,d){var e=LOOKUPS[a][0];null==e[d]&&(e[d]={}),null==e[d][b]&&(e[d][b]={}),null==e[d][b].status&&(e[d][b].status={}),null==e[d][b].response&&(e[d][b].response={}),null==e[d][b].status[c]&&(e[d][b].status[c]=STATUS_NONE)}function display(a,b,c,d,e){d||(d={});var f=getFullId(b,d);currentType=a,currentId=f,currentLocale=c,currentParams=d,currentExpansion=e,initElement(a,f,c,e);var g=LOOKUPS[a][0];g[e][f].status[c]==STATUS_INVALID?showTooltip(_LANG.invalid):g[e][f].status[c]==STATUS_OK||g[e][f].status[c]==STATUS_NOTFOUND?showTooltip(g[e][f][getTooltipField(c)],g[e][f][getIconField()],g[e][f].map,g[e][f][getSpellsField(c)],g[e][f][getTooltipField(c,2)],e):g[e][f].status[c]==STATUS_QUERYING||g[e][f].status[c]==STATUS_SCALES?showTooltip(_LANG.loading):request(a,b,c,null,d,e)}function request(a,b,c,d,e,f){var g=getFullId(b,e),h=LOOKUPS[a][0];if(h[f][g].status[c]==STATUS_NONE||h[f][g].status[c]==STATUS_ERROR){h[f][g].status[c]=STATUS_QUERYING,d||(h[f][g].timer=setTimeout(function(){showLoading.apply(this,[a,g,c,f])},333));var i="";for(var j in e)"rand"!=j&&"ench"!=j&&"gems"!=j&&"sock"!=j&&"lvl"!=j&&"pcs"!=j&&"transmog"!=j||("object"==typeof e[j]?i+="&"+j+"="+e[j].join(":"):!0===e[j]?i+="&"+j:i+="&"+j+"="+e[j]);var k=$oWoW.getDomainFromExpansion(f),l="//"+$oWoW.expUrl+"/"+k+"/";$oWoW.ajaxRequest(l+LOOKUPS[a][1]+"="+b+"&power=true"+i)}}function showTooltip(a,b,c,d,e,f){currentA&&currentA._fixTooltip&&(a=currentA._fixTooltip(a,currentType,currentId,currentA));a?null!=currentParams&&currentParams.c&&(a=a.replace(/<span class="c([0-9]+?)">(.+?)<\/span><br \/>/g,'<span class="c$1" style="display: none">$2</span>'),a=a.replace(new RegExp('<span class="c('+currentParams.c+')" style="display: none">(.+?)</span>',"g"),'<span class="c$1">$2</span><br />')):(a=LOOKUPS[currentType][2]+_LANG.notfound,b="inv_misc_questionmark"),1==mode?($oWoW.Tooltip.setIcon(null),$oWoW.Tooltip.show(currentA,a,null,null,null,e)):($oWoW.Tooltip.setIcon(b,f),$oWoW.Tooltip.showAtXY(a,cursorX,cursorY,CURSOR_HSPACE,CURSOR_VSPACE,e))}function showLoading(a,b,c,d){if(currentType==a&&currentId==b&&currentLocale==c&&currentExpansion==d){showTooltip(_LANG.loading);LOOKUPS[a][0][d][b].timer=setTimeout(function(){notFound.apply(this,[a,b,c,d])},3800)}}function notFound(a,b,c,d){LOOKUPS[a][0][d][b].status[c]=STATUS_ERROR,currentType==a&&currentId==b&&currentLocale==c&&currentExpansion==d&&showTooltip(_LANG.noresponse)}function getFullId(a,b,c){return a}var external=!0,headtag=document.getElementsByTagName("head")[0],method={type:3},currentType,currentId,currentLocale,currentDomain,currentParams,currentExpansion,currentA,cursorX,cursorY,mode=0,eventAttached=!1,npcs={},objects={},items={},quests={},spells={},achievements={},STATUS_NONE=0,STATUS_QUERYING=1,STATUS_ERROR=2,STATUS_NOTFOUND=3,STATUS_OK=4,STATUS_SCALES=5,STATUS_INVALID=6,TYPE_NPC=1,TYPE_OBJECT=2,TYPE_ITEM=3,TYPE_QUEST=5,TYPE_SPELL=6,TYPE_ACHIEVEMENT=10;if(CURSOR_HSPACE=15,CURSOR_VSPACE=15,_LANG={loading:"Loading...",noresponse:"No response",notfound:" not found",invalid:"Invalid tooltip"},LOOKUPS={1:[npcs,"npc","NPC"],2:[objects,"object","Object"],3:[items,"item","Item"],5:[quests,"quest","Quest"],6:[spells,"spell","Spell"],10:[achievements,"achievement","Achievement"]},SCALING={},LOCALES={0:"enus"},EXPANSIONS={0:"classic",1:"tbc",2:"wotlk",3:"cata",4:"mop",5:"wod"},external)var Locale={id:0,name:"enus"};this.init=function(){external&&$oWoW.ae(headtag,$oWoW.ce("link",{type:"text/css",href:$oWoW.cdnUrl+"/api/global.css",rel:"stylesheet"})),attachEvent(),onDOMReady(function(){if("undefined"!=typeof ttConf)for(var a=0;a<document.links.length;a++){var b=document.links[a];scanElement(b)}})},this.register=function(a,b,c,d,e){var f=LOOKUPS[a][0];if(initElement(a,b,c,e),SCALING[a]&&SCALING[a][c]!=SCALES_LOADED)return f[e][b].status[c]=STATUS_SCALES,void(f[e][b].response[c]=this.register.bind(this,a,b,c,d,e));f[e][b].timer&&(clearTimeout(f[e][b].timer),f[e][b].timer=null),!this.external&&d.map&&(null==f[e][b].map&&(f[e][b].map=new Mapper({parent:$oWoW.ce("div"),zoom:3,zoomable:!1,buttons:!1})),f[e][b].map.update(d.map),delete d.map),$oWoW.cO(f[e][b],d),f[e][b].status[c]!=STATUS_QUERYING&&f[e][b].status[c]!=STATUS_SCALES||(f[e][b][getTooltipField(c)]?f[e][b].status[c]=STATUS_OK:f[e][b].status[c]=STATUS_NOTFOUND),currentType==a&&b==currentId&&currentLocale==c&&currentExpansion==e&&showTooltip(f[e][b][getTooltipField(c)],f[e][b].icon,f[e][b].map,f[e][b][getSpellsField(c)],f[e][b][getTooltipField(c,2)],e)},this.regNpc=function(a,b,c,d){this.register(TYPE_NPC,a,b,c,d)},this.regObject=function(a,b,c,d){this.register(TYPE_OBJECT,a,b,c,d)},this.regItem=function(a,b,c,d){this.register(TYPE_ITEM,a,b,c,d)},this.regQuest=function(a,b,c,d){this.register(TYPE_QUEST,a,b,c,d)},this.regSpell=function(a,b,c,d){this.register(TYPE_SPELL,a,b,c,d)},this.regAchievement=function(a,b,c,d){this.register(TYPE_ACHIEVEMENT,a,b,c,d)},this.displayTextTooltip=function(a){showTooltip(a)},this.displayTooltip=function(a,b,c,d,e){display(a,b,c,d,e)},this.getStatus=function(a,b,c){var d=LOOKUPS[a][0];return null!=d[b]?d[b].status[c]:STATUS_NONE},this.refreshLinks=function(){if("undefined"!=typeof ttConf)for(var a=0;a<document.links.length;a++){for(var b=document.links[a],c=b.parentNode,d=!1;null!=c;){if((" "+c.className+" ").replace(/[\n\t]/g," ").indexOf(" wm-tt ")>-1){d=!0;break}c=c.parentNode}d||scanElement(b)}this.hideTooltip()},this.setParent=function(a){$oWoW.Tooltip.reset(),$oWoW.Tooltip.prepare(a)},external&&(this.set=function(a){$oWoW.cO(method,a)},this.showTooltip=function(a,b,c,d){updateCursorPos(a),showTooltip(b,c,null,null,null,d)},this.hideTooltip=function(){$oWoW.Tooltip.hide()},this.moveTooltip=function(a){onMouseMove(a)}),init()};"undefined"==typeof $_wm&&($_wm=$oWoWTooltip);